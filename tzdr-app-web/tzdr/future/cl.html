<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
    <title>国际原油</title>
    <link rel="stylesheet" type="text/css" href="../../css/mui.min.css"/>
    <link rel="stylesheet" type="text/css" href="../../css/own.css"/>
    <script type="text/javascript" src="../../js/mui.min.js" ></script>
	<script type="text/javascript" src="../../js/common.js"></script>
	<link rel="stylesheet" href="../../css/recharge.css" />
	<script src="../../js/jquery-1.11.3.js"></script>
	<style>
		.mui-table-view-cell div{
		float: left;	
		}
	</style>
	<script>
		mui.init();
		var paramListAll=null;
		var contractListAll=null;
    	var init_params=null;
		mui.plusReady(function(){
			
			loadCss();
    		function loadCss(){
    			var Proportion=1;
				var resolutionWidth=plus.screen.resolutionWidth;
				Proportion=resolutionWidth/320;
				console.log(Proportion);
				$(".ap_choosetitle").css({
					"height": Proportion*40+"px",
					"line-height":Proportion*40+"px",
					"font-size": Proportion*12+"px",
					"margin":"0px"
				});
				$(".ap_main .ap_choosetitle span").css({
					"height": Proportion*40+"px",
					"line-height":Proportion*40+"px",
				});
				$(".ap_main .ap_choosetitle b").css({
					"height": Proportion*40+"px",
					"line-height":Proportion*40+"px",
				});
				$(".sc_listsc").css({
					"margin-top":Proportion*5+"px",
					"padding":"0px "+Proportion*5+"px",
				});
				$(".mui-table-view-cell").css({
					"padding":Proportion*8+"px 0px",
//					"height":Proportion*29+"px ",
//					"line-height":Proportion*29+"px ",
					"font-size": Proportion*12+"px ",
				});
				$(".mui-table-view-cell div").css({
					"float":"left"
				});
				$(".mui-table-view-cell div:nth-child(1)").css({
					"width":Proportion*95+"px ",
				});
				$(".mui-table-view-cell div:nth-child(2").css({
					"width":Proportion*210+"px ",
				});
				$(".AgreementList ").css({
					"line-height":Proportion*40+"px",
					"font-size": Proportion*12+"px",
					"height":Proportion*80+"px",
					"padding-buttom":"10px"
				});
				$(".AgreementList p").css({
					"height":Proportion*40+"px!important",
					"line-height":Proportion*40+"px!important",
					"font-size": Proportion*12+"px !important",
				});
				$(".AgreementList  i").css({
					"display":"inline-block",
					"line-height":Proportion*40+"px",
					"font-size": Proportion*12+"px",
					"padding-buttom":"10px"
				});
				$("#buttomDiv").css({
					"line-height":Proportion*50+"px",
					"height":Proportion*50+"px",
				})
				$("#buttomDiv button").css({
					"line-height":Proportion*50+"px",
					"height":Proportion*50+"px",
				});
				$(".fontBlack").css({
					"color":"#2b2b2b",
					"font-size": Proportion*12+"px",
				});
				$(".grayFontDiv").css({
					"color":"#666666",
					"font-size": Proportion*12+"px",
					"margin-left":Proportion*10+"px",
				});
				$(".sc_listscStyle div:nth-child(1)").css({
						"width":Proportion*65+"px ",
				});
				$(".sc_listscStyle div:nth-child(2)").css({
						"width":Proportion*240+"px ",
				})
			}
			//初始化监听头部和底部事件
  			//获取国际原油数据
  			var paramUrl={
				url:"../login/login.html"
			}
  			mui.app_request("/ftrade/params",{
  				"businessType":6
  			},function(result){
  				 
  				if(!mui.isnull(result.data)){
  					paramListAll=result.data.paramList;
  					mui.each(paramListAll,function(i,item){
  						
  						//动态创建开仓手数子元素
  						createtranLevers(item);
  						//读取第一个默认的集合详细数据 
  						if(i==0){
  							setParams(item);
  							var lis=document.getElementById("trade_num").getElementsByTagName("li");
  						mui.each(lis,function(i,item){
  							if(i==0){
  								item.setAttribute("class","mui-table-view-cell mui-media mui-col-xs-3 on");
  							}  
  						});
  						}
  					});
  					//读取主力合约数据
  					mui.each(result.data.contractList,function(i,item){
  						setmainContract(item);
  					});
  					
  					
  					mui("#trade_num").on("tap","li",function(){
  						var lis=document.getElementById("trade_num").getElementsByTagName("li");
  						mui.each(lis,function(i,item){
  							if(item.getAttribute("class")=="mui-table-view-cell mui-media mui-col-xs-3 on"){
  								item.setAttribute("class","mui-table-view-cell mui-media mui-col-xs-3");
  							}
  						});
  						this.setAttribute("class","mui-table-view-cell mui-media mui-col-xs-3 on");
  						var tranLever_num=parseInt(this.innerHTML);
  						//切换详细数据
  						mui.each(paramListAll,function(i,item){
  							if(!mui.isnull(tranLever_num)&&tranLever_num==item.tranLever){
  								setParams(item);
  							}
  						});
  				});

  				}
  			},function(result){
  				mui.toast(result.message);
  				return;
  			},paramUrl)
//			document.getElementById("backPage").addEventListener("tap",function(){
//				mui.openWindow({
//					url:"../../home.html",
//					id:"home.html"
//				})
//			});
			document.getElementById("back").addEventListener("tap",function(){
		    			mui.back();
		    });
  			document.getElementById("openPay").addEventListener("tap",function(){
//				this.setAttribute('disabled','disabled')  //禁用按钮
  				openPays();
  			});
  			
  			document.getElementById("telservice").addEventListener("tap",function(){
  				mui.callService();
  			});
  			
  			document.getElementById("tran_info").addEventListener("tap",function(){
  				mui.openWindow("../agree/clru.html");
  			});
  			
  			document.getElementById("cl_info").addEventListener("tap",function(){
  				mui.openWindow("../agree/cl.html");
  			});
  			
  			
		});
		
		
		function createtranLevers(ParamsList){
			var trade_num=document.getElementById("trade_num");
			var li=document.createElement("li");
			li.setAttribute("class","mui-table-view-cell mui-media mui-col-xs-3");
			li.innerHTML=ParamsList.tranLever+"手";
			trade_num.appendChild(li);
		};
		
		function setParams(ParamsList){
			document.getElementById("traderBond").innerHTML=tzdr.moneyUtils.formatCurrency(ParamsList.traderBond)+"元";
			document.getElementById("traderTotal").innerHTML=tzdr.moneyUtils.formatCurrency(ParamsList.traderTotal)+"美元";
			document.getElementById("lineLoss").innerHTML=tzdr.moneyUtils.formatCurrency(ParamsList.lineLoss)+"美元";
			document.getElementById("paymentMoney").innerHTML=tzdr.moneyUtils.formatCurrency(ParamsList.traderBond)+"元";
			if(mui.isnull(ParamsList.manageFee)){
				document.getElementById("manageFee").innerHTML="免费";
			}else{
				document.getElementById("manageFee").innerHTML=ParamsList.manageFee+"元";
			}
			
			document.getElementById("tranFees").innerHTML=ParamsList.tranFees;
		};
		
		function setmainContract(contractList){
			document.getElementById("mainContract").innerHTML=contractList.mainContract;
		};
		
		
		function openPays(){
			var traderBond=document.getElementById("traderBond").innerHTML;
			var lis=document.getElementById("trade_num").getElementsByTagName("li");
			var trade_leve=null;
				mui.each(lis,function(i,item){
					if(item.getAttribute("class")=="mui-table-view-cell mui-media mui-col-xs-3 on"){
						trade_leve=item.innerHTML;
					}
				});
			traderBond=tzdr.moneyUtils.reverseMoney(traderBond);
			trade_leve=tzdr.moneyUtils.reverseMoney(trade_leve);
			
			if(mui.isnull(traderBond)||mui.isnull(trade_leve)){
				mui.toast("系统繁忙，请刷新再试！");
				return;
			}
				
			if (mui.cacheUser.isLogin()){
				var futurePaySuc = plus.webview.getWebviewById("futurePaySuc.html");
				
				if(futurePaySuc){
					futurePaySuc.close();
				}
				mui.openWindow({
				url:"pay.html",
				id:"pay.html",
				extras:{
					traderBond:traderBond,
					businessType:6,
					trade_leve:trade_leve,
					pageNumber:"cl.html"
				}
				});
//				mui.cacheUser.clearCachePages("cl.html");
			}
			else
			{
				mui.openWindow({url:"../login/login.html",id:"login",extras:{backpageID:"cl"}});
			}
		};
		
	</script>
</head>
<body>
	<header class="mui-bar mui-bar-nav own-topbg">
		<a class="mui-action-back mui-icon mui-icon-left-nav mui-pull-left" id="back"><i>返回</i></a>
		<h1 id="nav-title" class="mui-title">国际原油</h1>
		<a href="javascript:void(0);" class="top-tel" id="tran_info">操盘细则</a>
	</header>
<div class="mui-content ap_main">
	<h5 class="ap_choosetitle"><span>选择手数：</span><b>可持仓的最大手数</b></h5>
	<ul class="mui-table-view mui-grid-view mui-grid-9" id="trade_num">
		
	</ul>
	<ul class="mui-table-view sc_listsc">
		<li class="mui-table-view-cell">
			<label>操盘保证金(¥)：</label>
			<span id="traderBond">27,750元</span>
		</li>	
		<li class="mui-table-view-cell">
			<label>总操盘资金($)：</label>
			<span id="traderTotal">10,750美元</span>
		</li>
		<li class="mui-table-view-cell">
			<label>亏损平仓线($)：</label>
			<span id="lineLoss">10,450美元</span>
		</li>
	</ul>	
	<ul class="mui-table-view sc_listsc">
		<li class="mui-table-view-cell">
			<label>账户管理费(¥)：</label>
			<span id="manageFee">免费</span>
		</li>
		<li class="mui-table-view-cell">
			<div><label>交易手续费(¥)：</label></div>
			<div><span class="fontBlack"><i id="tranFees">58</i>元/单边</span><span class="grayFontDiv">(买入、卖出一手时各收取该数额（人民币）的交易手续费)</span></div>
		</li>
	</ul>	
	<ul class="mui-table-view  sc_listsc sc_listscStyle ">
		<li class="mui-table-view-cell">
			<label>投资标的：</label>
			<span>美原油期货当期主力合约<i id="mainContract">CL1603</i></span>
		</li>			
		<li class="mui-table-view-cell">
			<div><label>交易时间：</label></div>
			<div><span class="fontBlack">09:05-23:55</span><span class="grayFontDiv">（注意：请不要在交易时间外持单，以免被系统强制平仓）</span></div>
		</li>
	</ul>	
	<div class="mui-content-padded AgreementList" style="padding: 0px 5px;margin: 5px 0px 0px;">
		<p>提交申请表示阅读并同意<a href="javascript:void(0);" id="cl_info">《国际原油操盘合作协议》</a></p>
		<p><i id="telservice">新手可向客服索取模拟操盘账号：<a href="#">400-852-8008</a></i></p>
	</div>
	<!--<div class="mui-content-padded">
		<span class="mui-icon mui-icon mui-icon-info carefulIcon"></span><span class="order_tips">注意：</span>
		<p>提交申请表示阅读并同意<a href="javascript:void(0);" id="cl_info">《国际原油操盘合作协议》</a><br><i id="telservice">新手可向客服索取模拟操盘账号：<a href="#">400-852-8008</a></i></p>
	</div>	-->
	<div id="buttomDiv">
		<span>总计：<i class="yellowFont">¥</i><i id="paymentMoney"></i></span>
		<button type="button" id="openPay" class="mui-btn  lg-btnlogin">提交操盘申请</button>
	</div>
	<!--<div id="fiexdDiv">
		<div class="ac_btn">
		<button class="mui-btn mui-btn-block sc_listbtn" type="button" id="openPay">提交操盘申请</button>								
	</div>-->
	</div>
</div>
</body>
</html>