<!doctype html>
<html>

	<head>
		<meta charset="UTF-8">
		<title></title>
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<script src="../../js/mui.min.js"></script>
		 <script src="../../js/common.js"></script>
		<link rel="stylesheet" href="../../css/mui.min.css" />
		<link rel="stylesheet" href="../../css/own.css" />
		<link rel="stylesheet" href="../../css/quotation.css" />
		
	</head>

	<body>
		<header class="mui-bar mui-bar-nav">
		    <h1 class="mui-title" id="quotationTitle"><span>行情</span></h1>
		</header>
	<nav class="navlist">
		<a class="navon" href="javascript:void(0);" id="quotationMain">
			<span class="mui-icon"><img src="../../images/0.0.png" style="width: 20px;height:20px;"></span>
			<span class="mui-tab-label">行情</span>
		</a>
		<a class="" href="javascript:void(0);"  id="product">
			<span class="mui-icon"><img src="../../images/1.png" style="width: 20px;height:20px;"></span>
			<span class="mui-tab-label">操盘申请</span>
		</a>
		<a class="" href="javascript:void(0);"  id="scheme">
			<span class="mui-icon"><img src="../../images/2.png" style="width: 20px;height:20px;"></span>
			<span class="mui-tab-label">操盘记录</span>
		</a>
		<a class="" id="account" href="javascript:void(0);">
			<span class="mui-icon"><img src="../../images/3.png" style="width: 20px;height:20px;"></span>
			<span class="mui-tab-label" >账户</span>
		</a>
	</nav>
	<div class="mui-content">
		<div id="fisrtLlist"><span>合约名称</span><span>最新价</span><span>成交量</span><span>涨跌幅</span></div>
		<div class="productList">
			<a>
			<div class="productContentLeft" class="mui-col-xs-3">
				<p class="productName">国际原油</p>
				<p class="grayFont CommodityNo">CL1610</p>
			</div>
			<div class="productContentRight" class="mui-col-xs-9">
				<span class="redFont QLastPrice">35</span>
				<span class="LastVolume">3</span>
				<span><p class="redBg ChangeRate">+35%</p></span>
			</div>
			</a>
				<div class="productContentLeft" class="mui-col-xs-3">
				<p class="productName ">恒指期货</p>
				<p class="grayFont CommodityNo">HSI1608</p>
			</div>
			<div class="productContentRight" class="mui-col-xs-9">
				<span class="greenFont QLastPrice">3</span>
				<span class="LastVolume">5</span>
				<span ><p class="greenBg ChangeRate">-5%</p></span>
			</div>
			<div class="productContentLeft" class="mui-col-xs-3">
				<p class="productName">富时A50</p>
				<p class="grayFont CommodityNo">CN1608</p>
			</div>
			<div class="productContentRight" class="mui-col-xs-9">
				<span class="redFont QLastPrice">35</span>
				<span class="LastVolume">5</span>
				<span ><p class="redBg ChangeRate">+45%</p></span>
			</div>
				<div class="productContentLeft" class="mui-col-xs-3">
				<p class="productName">德国DAX</p>
				<p class="grayFont CommodityNo">DAX1609</p>
			</div>
			<div class="productContentRight" class="mui-col-xs-9">
				<span class="greenFont QLastPrice">5</span>
				<span class="LastVolume">5</span>
				<span ><p class="redBg ChangeRate">-3%</p></span>
			</div>
			<div class="productContentLeft" class="mui-col-xs-3">
				<p class="productName">美黄金</p>
				<p class="grayFont CommodityNo">GC1612</p>
			</div>
			<div class="productContentRight" class="mui-col-xs-9">
				<span class="redFont QLastPrice">3</span>
				<span class="LastVolume">34</span>
				<span ><p class="redBg ChangeRate">+5%</p></span>
			</div>
				<div class="productContentLeft" class="mui-col-xs-3">
				<p class="productName">小恒指</p>
				<p class="grayFont CommodityNo">MH1608</p>
			</div>
			<div class="productContentRight" class="mui-col-xs-9">
				<span class="greenFont QLastPrice">-</span>
				<span class="LastVolume">5</span>
				<span ><p class="redBg ChangeRate">-5%</p></span>
			</div>
			<div class="productContentLeft" class="mui-col-xs-3">
				<p class="productName">迷你道琼</p>
				<p class="grayFont CommodityNo">YM1609</p>
			</div>
			<div class="productContentRight" class="mui-col-xs-9">
				<span class="redFont QLastPrice">-</span>
				<span class="LastVolume">-</span>
				<span ><p class="redBg ChangeRate">-</p></span>
			</div>
				<div class="productContentLeft" class="mui-col-xs-3">
				<p class="productName">迷你纳斯达克</p>
				<p class="grayFont CommodityNo">NQ1609</p>
			</div>
			<div class="productContentRight" class="mui-col-xs-9">
				<span class="greenFont QLastPrice">-</span>
				<span class="LastVolume">-</span>
				<span ><p class="redBg ChangeRate">-</p></span>
			</div>
			<div class="productContentLeft" class="mui-col-xs-3">
				<p class="productName">日经225</p>
				<p class="grayFont CommodityNo">NK1609</p>
			</div>
			<div class="productContentRight" class="mui-col-xs-9">
				<span class="greenFont QLastPrice">-</span>
				<span class="LastVolume">-</span>
				<span ><p class="redBg ChangeRate">-</p></span>
			</div>
			<div class="productContentLeft" class="mui-col-xs-3">
				<p class="productName">迷你标准普尔</p>
				<p class="grayFont CommodityNo">ES1609</p>
			</div>
			<div class="productContentRight" class="mui-col-xs-9">
				<span class="greenFont QLastPrice">-</span>
				<span class="LastVolume">-</span>
				<span ><p class="redBg ChangeRate">-</p></span>
			</div>
		</div>
	</div>
		<script type="text/javascript">
			tzdr.init.initHearListener();
  			tzdr.init.initButtomListener(true);
			mui.init();
			mui.plusReady(function(){
						
			})
		var url = "ws://socket.dktai.com:9002";
					var socket = new WebSocket(url);
					function sendMessage(method,parameters){
					    socket.send('{"Method":"'+method+'","Parameters":'+parameters+'}');
					}
					
					
					socket.onopen = function(evt){
					    var user="13677622344";
					    var pwd="a123456";
					    socket.send('{"Method":"Login","Parameters":{"UserName":"' + user +'","PassWord":"' + pwd +'"}}');
					
					};
					var CommodityName=[];
					var CommodityNo1=[];
					var CommodityNo2=[];
					var DotSize=[];
					var product={
					    CommodityName:CommodityName,
					    CommodityNo1:CommodityNo1,
					    CommodityNo2:CommodityNo2,
					    DotSize:DotSize
					}
					socket.onclose = function(evt){
					};
					socket.onmessage = function(evt){
					    var data = evt.data;
					    var jsonData = JSON.parse(data);
					    var method = jsonData.Method;
					
					    if(method=="OnRspLogin"){
					        socket.send('{"Method":"QryCommodity","Parameters":""}');
					    }else if(method == "OnRspQryCommodity"){
					    	
					        var commoditys = jsonData.Parameters;
					        var size = commoditys.length;
					        var setTime=null;
					            console.log(commoditys);
					        for(var i=0;i<size;i++){
					            product.CommodityName[i]=commoditys[i].CommodityName;
					            product.CommodityNo1[i]=commoditys[i].MainContract;
					            product.CommodityNo2[i]=commoditys[i].CommodityNo;
					           	product.DotSize[i]=commoditys[i].DotSize;
					            socket.send('{"Method":"Subscribe","Parameters":{"CommodityNo":"'+commoditys[i].CommodityNo+'","ContractNo":"'+commoditys[i].MainContract+'"}}');
					        }
					    }else if(method == "OnRspQryHistory"){
					        var jsonData=JSON.parse(evt.data);
					    }else if(method == "OnRtnQuote"){					    
					         var MoreData=JSON.parse(evt.data);
					        	insertData(MoreData);
					    }
					};
					socket.onerror = function(evt){
					
					};
					setTimeout(function(){
						AddTo()
					},800)
				function AddTo(){
				    console.log(product.CommodityName.length);
				    var productList=document.getElementsByClassName("productList")[0];
				     productList.innerHTML=""
				    for(var i=0;i<product.CommodityName.length;i++){
           				 productList.innerHTML+="<a><div class='productContentLeft' class='mui-col-xs-3'>" +
                    " <p class='productName'>"+product.CommodityName[i]+"</p> " +
                    "<p class='grayFont CommodityNo'>"+product.CommodityNo2[i]+product.CommodityNo1[i]+"</p>" +
                    " </div> " +
                    "<div class='productContentRight' class='mui-col-xs-9'> " +
                    "<span class='reenFont QLastPrice'>-</span> <span class='LastVolume'>-</span> <span class='redBg ChangeRate'><p>-</p></span> </div></a>"

    				}
				}					
					
			function insertData(MoreData){
			   	var productName=document.getElementsByClassName("productName");
			   	var CommodityNo=document.getElementsByClassName("CommodityNo");
			    var LastVolume=document.getElementsByClassName("LastVolume");
			    var ChangeRate=document.getElementsByClassName("ChangeRate");
			    var LastPrice=document.getElementsByClassName("QLastPrice")
//			   	for(var i=0;i<productName.length;i++){
//			   		productName[i].innerText=product.CommodityName[i];
//			   		CommodityNo[i].innerText=product.CommodityNo2[i]+product.CommodityNo1[i];
//			   	}
//			   console.log(Number(MoreData.Parameters.QLastPrice)-Number(MoreData.Parameters.QPreSettlePrice))
//			   	if(MoreData.Parameters.CommodityNo=="CL"){
//			   		LastVolume[0].innerText=MoreData.Parameters.QLastVolume;
////			   		for(var j=0;j<product.CommodityName.length;j++){
//////			   			if(MoreData.Parameters.CommodityNo==product.CommodityNo2[j]){
//////			   			};
////			   			
////			   		}
//			   			
//			   	}else if(MoreData.Parameters.CommodityNo=="HSI"){
//			   		LastVolume[1].innerText=MoreData.Parameters.QLastVolume;
//			   	}else if(MoreData.Parameters.CommodityNo=="CN"){
//			   		LastVolume[2].innerText=MoreData.Parameters.QLastVolume;
//			   	}else if(MoreData.Parameters.CommodityNo=="DAX"){
//			   		LastVolume[3].innerText=MoreData.Parameters.QLastVolume;
//			   	}else if(MoreData.Parameters.CommodityNo=="GC"){
//			   		LastVolume[4].innerText=MoreData.Parameters.QLastVolume;
//			   	}else if(MoreData.Parameters.CommodityNo=="MHI"){
//			   		LastVolume[5].innerText=MoreData.Parameters.QLastVolume;
//			   	}else if(MoreData.Parameters.CommodityNo=="YM"){
//			   		LastVolume[6].innerText=MoreData.Parameters.QLastVolume;
//			   	}else if(MoreData.Parameters.CommodityNo=="NQ"){
//			   		LastVolume[7].innerText=MoreData.Parameters.QLastVolume;
//			   	}else if(MoreData.Parameters.CommodityNo=="NK"){
//			   		LastVolume[8].innerText=MoreData.Parameters.QLastVolume;
//			   	}else if(MoreData.Parameters.CommodityNo=="ES"){
//			   		LastVolume[9].innerText=MoreData.Parameters.QLastVolume;
//			   	}
				switch(MoreData.Parameters.CommodityNo){
					case "CL":
					LastVolume[0].innerText=MoreData.Parameters.QLastVolume;
					if(Number(MoreData.Parameters.QChangeRate.toFixed(4))<0){
						ChangeRate[0].innerText=MoreData.Parameters.QChangeRate.toFixed(2)+"%";
						
						ChangeRate[0].className="greenBg ChangeRate";
					}else{
						ChangeRate[0].innerText="+"+MoreData.Parameters.QChangeRate.toFixed(2)+"%";
						ChangeRate[0].className="redBg ChangeRate"
					}
					if(Number(MoreData.Parameters.QLastPrice)-Number(MoreData.Parameters.QPreSettlePrice)<0){
						LastPrice[0].innerText=MoreData.Parameters.QLastPrice.toFixed(product.DotSize[0]);
						LastPrice[0].className="greenFont QLastPrice"
					}else{
						LastPrice[0].innerText=MoreData.Parameters.QLastPrice.toFixed(product.DotSize[0]);;
						LastPrice[0].className="redFont QLastPrice"	
					}
					 break;
					 case "HSI":
					 	LastVolume[1].innerText=MoreData.Parameters.QLastVolume;
					 	if(Number(MoreData.Parameters.QChangeRate.toFixed(2))<0){
						ChangeRate[1].innerText=MoreData.Parameters.QChangeRate.toFixed(2)+"%";
						ChangeRate[1].className="greenBg ChangeRate";
					}else{
						ChangeRate[1].innerText="+"+MoreData.Parameters.QChangeRate.toFixed(2)+"%";
						ChangeRate[1].className="redBg ChangeRate"
					};
					if(Number(MoreData.Parameters.QLastPrice)-Number(MoreData.Parameters.QPreSettlePrice)<0){
						LastPrice[1].innerText=MoreData.Parameters.QLastPrice.toFixed(product.DotSize[1]);;
						LastPrice[1].className="greenFont QLastPrice"
					}else{
						LastPrice[1].innerText=MoreData.Parameters.QLastPrice.toFixed(product.DotSize[1]);;
						LastPrice[1].className="redFont QLastPrice"	
					};
					 	 break;
					 case "CN":
					 	LastVolume[2].innerText=MoreData.Parameters.QLastVolume;
					 	if(Number(MoreData.Parameters.QChangeRate.toFixed(2))<0){
						ChangeRate[2].innerText=MoreData.Parameters.QChangeRate.toFixed(2)+"%";
					
						ChangeRate[2].className="greenBg ChangeRate";
					}else{
						ChangeRate[2].innerText="+"+MoreData.Parameters.QChangeRate.toFixed(2)+"%";
						ChangeRate[2].className="redBg ChangeRate"
					};
					if(Number(MoreData.Parameters.QLastPrice)-Number(MoreData.Parameters.QPreSettlePrice)<0){
						LastPrice[2].innerText=MoreData.Parameters.QLastPrice.toFixed(product.DotSize[2]);;
						LastPrice[2].className="greenFont QLastPrice"
					}else{
						LastPrice[2].innerText=MoreData.Parameters.QLastPrice.toFixed(product.DotSize[2]);;
						LastPrice[2].className="redFont QLastPrice"	
					}
					 	 break;
					 case "DAX":
					 	LastVolume[3].innerText=MoreData.Parameters.QLastVolume;
					 	if(Number(MoreData.Parameters.QChangeRate.toFixed(2))<0){
						ChangeRate[3].innerText=MoreData.Parameters.QChangeRate.toFixed(2)+"%";
						
						ChangeRate[3].className="greenBg ChangeRate";
					}else{
						ChangeRate[3].innerText="+"+MoreData.Parameters.QChangeRate.toFixed(2)+"%";
						ChangeRate[3].className="redBg ChangeRate"
					};
					if(Number(MoreData.Parameters.QLastPrice)-Number(MoreData.Parameters.QPreSettlePrice)<0){
						LastPrice[3].innerText=MoreData.Parameters.QLastPrice.toFixed(product.DotSize[3]);;
						LastPrice[3].className="greenFont QLastPrice"
					}else{
						LastPrice[3].innerText=MoreData.Parameters.QLastPrice.toFixed(product.DotSize[3]);;
						LastPrice[3].className="redFont QLastPrice"	
					};
					 	 break;
					 case "GC":
					 	LastVolume[4].innerText=MoreData.Parameters.QLastVolume;
					 	if(Number(MoreData.Parameters.QChangeRate.toFixed(2))<0){
						ChangeRate[4].innerText=MoreData.Parameters.QChangeRate.toFixed(2)+"%";
						
						ChangeRate[4].className="greenBg ChangeRate";
					}else{
						ChangeRate[4].innerText="+"+MoreData.Parameters.QChangeRate.toFixed(2)+"%";
						ChangeRate[4].className="redBg ChangeRate"
					};
					if(Number(MoreData.Parameters.QLastPrice)-Number(MoreData.Parameters.QPreSettlePrice)<0){
						LastPrice[4].innerText=MoreData.Parameters.QLastPrice.toFixed(product.DotSize[4]);;
						LastPrice[4].className="greenFont QLastPrice"
					}else{
						LastPrice[4].innerText=MoreData.Parameters.QLastPrice.toFixed(product.DotSize[4]);;
						LastPrice[4].className="redFont QLastPrice"	
					}
					 	 break;
					 case "MHI":
					 	LastVolume[5].innerText=MoreData.Parameters.QLastVolume;
					 	if(Number(MoreData.Parameters.QChangeRate.toFixed(2))<0){
						ChangeRate[5].innerText=MoreData.Parameters.QChangeRate.toFixed(2)+"%";
						
						ChangeRate[5].className="greenBg ChangeRate";
					}else{
						ChangeRate[5].innerText="+"+MoreData.Parameters.QChangeRate.toFixed(2)+"%";
						ChangeRate[5].className="redBg ChangeRate";
					};
					if(Number(MoreData.Parameters.QLastPrice)-Number(MoreData.Parameters.QPreSettlePrice)<0){
						LastPrice[5].innerText=MoreData.Parameters.QLastPrice.toFixed(product.DotSize[5]);;
						LastPrice[5].className="greenFont QLastPrice"
					}else{
						LastPrice[5].innerText=MoreData.Parameters.QLastPrice.toFixed(product.DotSize[5]);;
						LastPrice[5].className="redFont QLastPrice"	
					}
					 	 break;
					 case "YM":
					 	LastVolume[6].innerText=MoreData.Parameters.QLastVolume;
					 	 break;
					 case "Yk":
					 	LastVolume[7].innerText=MoreData.Parameters.QLastVolume;
					 	 break;
					 case "NQ":
					 	LastVolume[8].innerText=MoreData.Parameters.QLastVolume;
					 	 break;
					 case "ES":
					 	LastVolume[9].innerText=MoreData.Parameters.QLastVolume;
					 	 break;
					
				}
			}
		</script>
	</body>
</html>